---
title: "FTSE 100 Time-Series Modeling" 
subtitle: "Coursework 1 " 
author: "Najwa Haifa Hedar" 
date: "Spring term 2025" 
output: 
  html_document:
    toc: true
    toc_float: true
    theme: spacelab 
    highlight: tango
---
 
```{r, echo=FALSE}
# This code will display the QMUL logo at the top right of the page
# Do not change this code
htmltools::img(src = knitr::image_uri("images/QMlogo.png"),
               alt = 'logo',
               style = 'position:absolute; top:0; right:0; padding:10px; width:20%;')
```

## 1 Introduction
The performance of the top 100 publicly traded firms on the London Stock Exchange is represented by the FTSE 100 Index, which is widely regarded as the most significant financial benchmarks in the United Kingdom. This indicator is utilised by financial experts, investors, and policy-makers to assess the state of the economy and make informed investment decisions.

In this project, we employ Meta's Prophet model, a sophisticated forecasting tool created by Facebook, to analyse the historical trends of the FTSE 100 index and project its future movement. Additionally, we utilise linear regression as a benchmark model to evaluate Prophet's prediction capabilities against a more elementary statistical approach. By employing these methodologies, we seek to investigate long-term trends, the impact of seasonality, and potential fluctuations over the next two years. 

## 2 Data Collection & Preprocessing

### Load Necessary Library
```{r}
library(quantmod) #Financial Data Retrieval
library(prophet) #Forecasting Model
library(tidyverse) #Data Manipulation & Visualization
library(ggplot2) #Plotting
library(zoo) #Time-Series Processing
```

### Retrieve FTSE 100 Data from Yahoo Finance
```{r}
#Get FTSE 100 data from Yahoo Finance
getSymbols("^FTSE", src = "yahoo", auto.assign = TRUE)

#Convert into a Dataframe with date and adjusted closing price
ftse_data <- data.frame(
    ds = index(FTSE),
    y = as.numeric(FTSE$FTSE.Adjusted)
)

#Display first few rows
head(ftse_data)
```

### Handle Missing Values
```{r}
#Check for missing values
sum(is.na(ftse_data))

#Remove missing values
ftse_data <- na.omit(ftse_data)

#Verify missing values removed
sum(is.na(ftse_data))
```


## 3 Exploratory Data Analysis

### Historical Trends of FTSE 100
```{r}
#Line plot of FTSE 100 historical trends
ggplot(ftse_data, aes(x= ds, y=y))+
    geom_line(color = "blue")+
    labs(title = "FTSE 100 Index Trends (Historical Data)",
         x = "Year",
         y = "Index Value")+
    theme_minimal()
```

## 4 Comparison with Linear Regression

### Fit the Linear Regression
```{r}
#Convert date column into numeric for regression model
linear_model <- lm(y ~ as.numeric(ds), data = ftse_data)

#Convert date column 'ds' into numeric
min_ds <- as.numeric(min(ftse_data$ds))
max_ds <- as.numeric(max(ftse_data$ds))

#Create future dates sequence (Adding 730 days to forecast 2 years ahead)
future_ds <- data.frame(ds = seq(from = min_ds, to = max_ds + 730, by= 1))

#Convert numeric back to Date format for readability
future_ds$ds <- as.Date(future_ds$ds, origin = "1970-01-01")

#Predict future FTSE 100 values using linear regression
future_ds$y_pred <- predict(linear_model, newdata= future_ds)

#Plot the linear regression forecast
ggplot(ftse_data, aes( x = ds, y = y))+
    geom_line(color = "blue") +
    geom_line(data = future_ds, aes(x = ds, y = y_pred), color = "red", linetype = "dashed") + 
    labs(title = "FTSE 100 Index Trends with Linear Regression",
         x = "Year",
         y = "Index Value")+
    theme_minimal()
```

## 5 Forecasting FTSE 100 with Prophet

### Train Prophet Model
```{r}
#Train Prophet model with daily seasonality enabled
ftse_model <- prophet(ftse_data, daily.seasonality = TRUE)
```

### Create Future Timeframe (Next 2 Years)
```{r}
#Generate future dates for prediction (2 years ahead)
future_ftse <- make_future_dataframe(ftse_model, periods = 730, freq = "day")
```

### Generate Forecast
```{r}
#Predict FTSE 100 Values
forecast_ftse <- predict(ftse_model, future_ftse)
```

## 6 Forecast Visualization

### FTSE 100 Forecast (Next 2 Years)
```{r}
#Plot the Forecast trend
plot(ftse_model, forecast_ftse)+
    labs(title = "FTSE 100 Forecast (Next 2 Years)")
```

## 7 Seasonality & Trend Components

### Breaking Down FTSE 100 Patterns
```{r}
#Decomposing FTSE 100 into trend & sesonality components
prophet_plot_components(ftse_model, forecast_ftse)
```

## 8 Conclusion & Key Takeaways
The historical trends graph displays the overall evolution of the FTSE 100 Index across time while marking major economic downturns including the 2008 financial crisis and the COVID-19 crash in 2020 and subsequent periods of recovery and growth. This visualization aids in recognizing extended market cycles and interpreting the impact of the external events on stock prices.

The Prophet forecast graph builds on this analysis with predictions about FTSE 100 movements for the upcoming two-year period. While historical trends reveal past index performance, this graph projects future index direction with a blue uncertainty band that grows wider as the prediction extends to show mounting unpredictability. Compared to linear regression, which assumes a constant trend and ignores seasonality, Prophet provides a more dynamic and realistic projection because it takes market cycles and fluctuations into account. Investors and financial planners find this tool beneficial since it helps them forecast market changes and modify their investment approaches appropriately. 

The seasonality breakdown graph provides an advanced analysis of market patterns through the isolation of both weekly and yearly cycles. The FTSE 100 index demonstrates consistent price increases at the beginning of the week, followed by declines as the week concludes due to possible influences from trading behaviour and market sentiment along with institutional investment strategies. The yearly component displays consistent patterns that are possibly connected to corporate earnings seasons along with tax deadlines and worldwide economic trends. This analysis enables short-term traders to pinpoint the best times to enter or exit the market while the Prophet forecast method looks at long-term market trends. 

## 9 References
- R for Data Science (Hadley Wickham & Garrett Grolemund): <https://r4ds.had.co.nz/index.html>
- Facebook's Prophet Documentation: <https://facebook.github.io/prophet/>
- Yahoo Finance FTSE 100 Historical Data: <https://finance.yahoo.com/quote/%5EFTSE/history>